
Scipt SQL para criar DB e tabelas e dados para ambientes de desenvolvimento, testes ou atualiza√ß√µes automatizadas.
script SQL idempotente ‚Äîpode ser executado v√°rias vezes sem causar erros como duplica√ß√£o de tabelas, triggers ou dados.
Todas as tabelas usam CREATE TABLE IF NOT EXISTS 
Triggers usam DROP TRIGGER IF EXISTS antes de serem recriadas 
Inserts usam INSERT IGNORE para evitar duplica√ß√£o 
Ordem de cria√ß√£o respeita depend√™ncias (sem erro de chave estrangeira) 
Removido relacionamento circular entre servicos e solicitacoes 
Script est√° limpo, seguro e pronto para m√∫ltiplas execu√ß√µes 




Estrutura do Sistema Web SISCHAMADOS
1 - Planejamento e Arquitetura
   Definir tecnologias, estrutura de pastas, e padr√µes de desenvolvimento.

Tipo de aplica√ß√£o:  MPA (Multi Page Application) 
Backend: PHP (python ou node) 
Frontend: HTML/CSS/JS   framework (React, Vue.js, Angular, HTML/CSS/JS puro)
Banco de dados: MySQL 
Hospedagem: Local
deve rodar offline - bibliotecas devem ser locais
acessado apenas por usu√°rios internos 

Autentica√ß√£o e Controle de Acesso
Criar login seguro, sess√µes, e controle por tipo de usu√°rio.
Criptografia de senhas (ex: bcrypt) 
Sess√µes ou JWT (tokens) 
autentica√ß√£o via: Sess√£o tradicional (cookies)   [ JWT (token no frontend) ]
          
Cadastro e Gerenciamento de Chamados
Criar, visualizar, editar e encerrar chamados.
Formul√°rio de abertura com campos din√¢micos 
Listagem com filtros (status, prioridade, executor) 
Edi√ß√£o e encerramento com hist√≥rico 
Layout dos formul√°rios 
Permiss√µes de edi√ß√£o por tipo de usu√°rio 
üîπ Parte 4: Painel Administrativo com Gr√°ficos e Filtros
Visualizar estat√≠sticas e relat√≥rios, tend√™nciass
    ‚Ä¢ Gr√°ficos de chamados por status, tempo m√©dio de resolu√ß√£o, etc. 
    ‚Ä¢ Filtros por data, executor, tipo de servi√ßo 
    ‚Ä¢ Exporta√ß√£o para PDF/Excel 
    ‚Ä¢ Chart.js ou ApexCharts para gr√°ficos 
    ‚Ä¢ DataTables ou AG Grid para tabelas 
    ‚Ä¢ Chamados por status 
    ‚Ä¢  Tempo m√©dio de resolu√ß√£o 
    ‚Ä¢ Avalia√ß√£o m√©dia por executor 
       
5 - Sistema de Avalia√ß√£o
Permitir que o solicitante avalie o servi√ßo 
    ‚Ä¢ Avalia√ß√£o do servi√ßo por nota
    ‚Ä¢ Coment√°rio opcional 
    ‚Ä¢ Exibi√ß√£o no perfil do executor 
    ‚Ä¢ Quando a avalia√ß√£o ser√° liberada (ap√≥s encerramento?) 
    ‚Ä¢ Se ser√° obrigat√≥ria ou opcional 
Notifica√ß√µes por Email e WhatsApp e direct chat
 Informar usu√°rios sobre atualiza√ß√µes de chamados.
    ‚Ä¢ Notifica√ß√£o ao abrir, atualizar ou encerrar chamado 
    ‚Ä¢ Confirma√ß√£o de recebimento 
    ‚Ä¢ Alertas de prazo 
Tecnologias sugeridas:
    ‚Ä¢ Email: SMTP via PHPMailer, Nodemailer, ou SendGrid 
    ‚Ä¢ WhatsApp: API do WhatsApp Business ou Twilio 

       
Interface Responsiva e Usabilidade
Garantir que o sistema funcione bem em desktop e mobile.
Funcionalidades:
    ‚Ä¢ Layout adapt√°vel (Bootstrap, Tailwind, ou CSS puro) 
    ‚Ä¢ Menu lateral ou superior 
    ‚Ä¢ Modo escuro (opcional) 
Question√°rio:
    1. Deseja usar um framework CSS? 
        ‚ó¶ ( ) Bootstrap 
        ‚ó¶ ( ) Tailwind 
        ‚ó¶ ( ) Nenhum 
    2. Deseja incluir modo escuro? 
    ‚Ä¢ ( ) Sim 
    ‚Ä¢ ( ) N√£o 
üîπ Parte 8: Seguran√ßa e Logs
Objetivo: Proteger dados e registrar a√ß√µes dos usu√°rios.
Funcionalidades:
    ‚Ä¢ Logs de acesso e a√ß√µes 
    ‚Ä¢ Prote√ß√£o contra SQL Injection e XSS 
    ‚Ä¢ Backup autom√°tico do banco 
üîπ Parte 9: Deploy e Manuten√ß√£o
Objetivo: Colocar o sistema em produ√ß√£o e garantir estabilidade.
Etapas:
    ‚Ä¢ Configura√ß√£o de servidor 
    ‚Ä¢ Backup e monitoramento 
    ‚Ä¢ Documenta√ß√£o t√©cnica 



















Roteiro de Desenvolvimento por M√≥dulo
üîπ 1. Autentica√ß√£o e Sess√£o
Arquivos envolvidos:
‚Ä¢ 	: formul√°rio de login
‚Ä¢ 	: encerra sess√£o
‚Ä¢ 	: conex√£o com MySQL
‚Ä¢ 	: verifica sess√£o e exibe usu√°rio
‚Ä¢ 	: fecha HTML
Tarefas:
‚Ä¢ 	Implementar login com verifica√ß√£o de senha (criptografada com bcrypt)
‚Ä¢ 	Criar sess√£o com 
‚Ä¢ 	Redirecionar por tipo de usu√°rio ( ou )
‚Ä¢ 	Proteger p√°ginas com verifica√ß√£o de sess√£o

üîπ 2. Layout e Navega√ß√£o
Arquivos envolvidos:
‚Ä¢ 	: inclui sidebar com links, logo, t√≠tulo
‚Ä¢ 	: rodap√© padronizado
‚Ä¢ 	: define cores, fontes, responsividade
Tarefas:
‚Ä¢ 	Criar sidebar com links para: Dashboard, Novo Chamado, Relat√≥rios, M√©tricas, etc.
‚Ä¢ 	Adicionar topbar com nome do usu√°rio e bot√£o de logout
‚Ä¢ 	Aplicar estilo uniforme com header iniciando as paginas e o footer fechando.

üîπ 3. Dashboard e Resumo
Arquivos envolvidos:
‚Ä¢ 	: resumo de chamados e servi√ßos
‚Ä¢ 	: gr√°ficos e indicadores
Tarefas:
‚Ä¢ 	Mostrar total de chamados abertos, em execu√ß√£o, conclu√≠dos
‚Ä¢ 	Gr√°ficos com Chart.js: chamados por status, por prioridade
‚Ä¢ 	Cards com produtividade e satisfa√ß√£o

üîπ 4. Chamados e Servi√ßos
Arquivos envolvidos:
‚Ä¢ 	: formul√°rio de novo chamado
‚Ä¢ 	: grava no banco
‚Ä¢ 	: formul√°rio de edi√ß√£o
‚Ä¢ 	: atualiza no banco
‚Ä¢ 	: exibe hist√≥rico de a√ß√µes
‚Ä¢ 	: mensagens entre solicitante e executor
Tarefas:
‚Ä¢ 	Criar formul√°rio com campos din√¢micos (prioridade, tipo, prazo)
‚Ä¢ 	Listar chamados com filtros por status, executor, data
‚Ä¢ 	Registrar hist√≥rico de altera√ß√µes
‚Ä¢ 	Implementar chat simples por servi√ßo

üîπ 5. Avalia√ß√£o e Satisfa√ß√£o
Arquivos envolvidos:
‚Ä¢ 	: formul√°rio de avalia√ß√£o
‚Ä¢ 	: gr√°fico de m√©dia de notas
Tarefas:
‚Ä¢ 	Permitir avalia√ß√£o ap√≥s encerramento do chamado
‚Ä¢ 	Registrar nota (1 a 5) e coment√°rio
‚Ä¢ 	Exibir m√©dia por executor e por tipo de servi√ßo

üîπ 6. M√©tricas e Produtividade
Arquivos envolvidos:
‚Ä¢ 	: tempo m√©dio de resolu√ß√£o
‚Ä¢ 	: servi√ßos por executor
‚Ä¢ 	 / : exporta√ß√µes
Tarefas:
‚Ä¢ 	Calcular tempo m√©dio por tipo de servi√ßo
‚Ä¢ 	Listar produtividade por executor
‚Ä¢ 	Exportar relat√≥rios em Excel e PDF (via )

üîπ 7. Relat√≥rios e Exporta√ß√µes
Arquivos envolvidos:
‚Ä¢ 	: filtros e visualiza√ß√£o
‚Ä¢ 	 / : exporta√ß√µes gerais
Tarefas:
‚Ä¢ 	Filtros por data, executor, status
‚Ä¢ 	Exportar resultados em Excel (PhpSpreadsheet) e PDF (DOMPDF)

üîπ 8. Infraestrutura e Recursos
Arquivos envolvidos:
‚Ä¢ 	: estrutura do banco
‚Ä¢ 	: armazenamento de arquivos anexados
‚Ä¢ 	: bibliotecas externas via Composer
Tarefas:
‚Ä¢ 	Garantir que  tenha permiss√£o 755
‚Ä¢ 	Instalar depend√™ncias com  e 
‚Ä¢ 	Validar seguran√ßa de arquivos enviados

üß™ Question√°rio Final de Configura√ß√£o
1. 	Deseja que o sistema tenha modo escuro?
‚Ä¢ 	( ) Sim
‚Ä¢ 	(x) N√£o
2. 	Deseja que o chat tenha notifica√ß√µes em tempo real?
‚Ä¢ 	( ) Sim, com WebSocket
‚Ä¢ 	(x) N√£o, com atualiza√ß√£o manual
3. 	Deseja que o sistema envie e-mails automaticamente?
‚Ä¢ 	(x) Sim
‚Ä¢ 	( ) N√£o
4. 	Deseja integra√ß√£o com WhatsApp?
‚Ä¢ 	(x) Sim, via API Business
‚Ä¢ 	( ) N√£o



Roteiro de Desenvolvimento por M√≥dulo
üîπ 1. Autentica√ß√£o e Sess√£o
Arquivos envolvidos:
    ‚Ä¢ login.php: formul√°rio de login 
    ‚Ä¢ logout.php: encerra sess√£o 
    ‚Ä¢ conexao.php: conex√£o com MySQL 
    ‚Ä¢ header.php: verifica sess√£o e exibe usu√°rio 
    ‚Ä¢ footer.php: fecha HTML 
Tarefas:
    ‚Ä¢ Implementar login com verifica√ß√£o de senha (criptografada com bcrypt) 
    ‚Ä¢ Criar sess√£o com $_SESSION['usuario_id'] 
    ‚Ä¢ Redirecionar por tipo de usu√°rio (admin ou comum) 
    ‚Ä¢ Proteger p√°ginas com verifica√ß√£o de sess√£o 
üîπ 2. Layout e Navega√ß√£o
Arquivos envolvidos:
    ‚Ä¢ header.php: inclui sidebar com links, logo, t√≠tulo 
    ‚Ä¢ footer.php: rodap√© padronizado 
    ‚Ä¢ estilo.css: define cores, fontes, responsividade 
Tarefas:
    ‚Ä¢ Criar sidebar com links para: Dashboard, Novo Chamado, Relat√≥rios, M√©tricas, etc. 
    ‚Ä¢ Adicionar topbar com nome do usu√°rio e bot√£o de logout 
    ‚Ä¢ Aplicar estilo uniforme com estilo.css 
üîπ 3. Dashboard e Resumo
Arquivos envolvidos:
    ‚Ä¢ index.php: resumo de chamados e servi√ßos 
    ‚Ä¢ dashboard.php: gr√°ficos e indicadores 
Tarefas:
    ‚Ä¢ Mostrar total de chamados abertos, em execu√ß√£o, conclu√≠dos 
    ‚Ä¢ Gr√°ficos com Chart.js: chamados por status, por prioridade 
    ‚Ä¢ Cards com produtividade e satisfa√ß√£o 
üîπ 4. Chamados e Servi√ßos
Arquivos envolvidos:
    ‚Ä¢ novo.php: formul√°rio de novo chamado 
    ‚Ä¢ salvar.php: grava no banco 
    ‚Ä¢ editar.php: formul√°rio de edi√ß√£o 
    ‚Ä¢ atualizar.php: atualiza no banco 
    ‚Ä¢ historico.php: exibe hist√≥rico de a√ß√µes 
    ‚Ä¢ chat.php: mensagens entre solicitante e executor 
Tarefas:
    ‚Ä¢ Criar formul√°rio com campos din√¢micos (prioridade, tipo, prazo) 
    ‚Ä¢ Listar chamados com filtros por status, executor, data 
    ‚Ä¢ Registrar hist√≥rico de altera√ß√µes 
    ‚Ä¢ Implementar chat simples por servi√ßo 
üîπ 5. Avalia√ß√£o e Satisfa√ß√£o
Arquivos envolvidos:
    ‚Ä¢ avaliar.php: formul√°rio de avalia√ß√£o 
    ‚Ä¢ satisfacao.php: gr√°fico de m√©dia de notas 
Tarefas:
    ‚Ä¢ Permitir avalia√ß√£o ap√≥s encerramento do chamado 
    ‚Ä¢ Registrar nota (1 a 5) e coment√°rio 
    ‚Ä¢ Exibir m√©dia por executor e por tipo de servi√ßo 
üîπ 6. M√©tricas e Produtividade
Arquivos envolvidos:
    ‚Ä¢ metricas.php: tempo m√©dio de resolu√ß√£o 
    ‚Ä¢ produtividade.php: servi√ßos por executor 
    ‚Ä¢ exportar_produtividade_excel.php / pdf.php: exporta√ß√µes 
Tarefas:
    ‚Ä¢ Calcular tempo m√©dio por tipo de servi√ßo 
    ‚Ä¢ Listar produtividade por executor 
    ‚Ä¢ Exportar relat√≥rios em Excel e PDF (via vendor/) 
üîπ 7. Relat√≥rios e Exporta√ß√µes
Arquivos envolvidos:
    ‚Ä¢ relatorio.php: filtros e visualiza√ß√£o 
    ‚Ä¢ exportar_excel.php / exportar_pdf.php: exporta√ß√µes gerais 
Tarefas:
    ‚Ä¢ Filtros por data, executor, status 
    ‚Ä¢ Exportar resultados em Excel (PhpSpreadsheet) e PDF (DOMPDF) 
üîπ 8. Infraestrutura e Recursos
Arquivos envolvidos:
    ‚Ä¢ banco.sql: estrutura do banco 
    ‚Ä¢ uploads/: armazenamento de arquivos anexados 
    ‚Ä¢ vendor/: bibliotecas externas via Composer 
Tarefas:
    ‚Ä¢ Garantir que uploads/ tenha permiss√£o 755 
    ‚Ä¢ Instalar depend√™ncias com composer require dompdf/dompdf e phpoffice/phpspreadsheet 
    ‚Ä¢ Validar seguran√ßa de arquivos enviados 
üß™ Question√°rio Final de Configura√ß√£o
    1. Deseja que o sistema tenha modo escuro? 
        ‚ó¶ ( ) Sim 
        ‚ó¶ (x) N√£o 
    2. Deseja que o chat tenha notifica√ß√µes em tempo real? 
        ‚ó¶ ( ) Sim, com WebSocket 
        ‚ó¶ (x) N√£o, com atualiza√ß√£o manual 
    3. Deseja que o sistema envie e-mails automaticamente? 
        ‚ó¶ (x) Sim 
        ‚ó¶ ( ) N√£o 
    4. Deseja integra√ß√£o com WhatsApp? 
    ‚Ä¢ (x) Sim, via API Business 
    ‚Ä¢ ( ) N√£o 



M√≥dulo 1: Autentica√ß√£o e Sess√£o. Esse m√≥dulo garante que apenas usu√°rios autorizados acessem o sistema e que suas sess√µes sejam mantidas com seguran√ßa.

üìÅ Arquivos envolvidos
Arquivo	Fun√ß√£o
login.php	Formul√°rio de login + verifica√ß√£o de credenciais
logout.php	Finaliza a sess√£o e redireciona para login
conexao.php	Conecta ao banco de dados
header.php	Verifica se o usu√°rio est√° logado + inicia sess√£o
footer.php	Fecha o HTML das p√°ginas






M√≥dulo 2: Layout e Navega√ß√£o
This module ensures that every page has a consistent look, intuitive navigation, and responsive design.
üìÅ Arquivos envolvidos
Arquivo	Fun√ß√£o
header.php	Inicia todas as p√°ginas, inclui topbar e sidebar
footer.php	Fecha o HTML, inclui rodap√©
css/estilo.css	Define o estilo visual do sistema
assets/	Cont√©m imagens como logo e √≠cones


4. assets/
Certifique-se de que os seguintes arquivos existam:
    ‚Ä¢ favicon.png: √≠cone do sistema 
    ‚Ä¢ login-illustration.png: imagem decorativa para a tela de login 
    ‚Ä¢ favicon.ico: √≠cone para a aba do navegador 
‚úÖ Resultado
Com esse m√≥dulo, todas as p√°ginas ter√£o:
    ‚Ä¢ Uma topbar com logo, t√≠tulo e usu√°rio logado 
    ‚Ä¢ Uma sidebar com √≠cones e links para os principais m√≥dulos 
    ‚Ä¢ Um rodap√© fixo com copyright 
    ‚Ä¢ Um layout responsivo e limpo 

Dashboard (index.php) ‚Äî a p√°gina inicial do sistema SisChamados, onde o usu√°rio visualiza um resumo dos chamados e servi√ßos, com indicadores e gr√°ficos simples.

üìä M√≥dulo: Dashboard (index.php)
üéØ Objetivo
Exibir:
    ‚Ä¢ Total de chamados por status 
    ‚Ä¢ Total de servi√ßos por prioridade 
    ‚Ä¢ Gr√°ficos simples com Chart.js 
    ‚Ä¢ Cards com produtividade e satisfa√ß√£o 

üìÅ Arquivos envolvidos
Arquivo	Fun√ß√£o
index.php	P√°gina principal com resumo e gr√°ficos
header.php	Layout superior e navega√ß√£o
footer.php	Rodap√© da p√°gina
conexao.php	Conex√£o com o banco
css/estilo.css	Estilo dos cards e gr√°ficos
assets/js/chart.min.js	Biblioteca de gr√°ficos Chart.js


1. Adicione Chart.js
Coloque o arquivo chart.min.js em assets/js/ ou use CDN:
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

Claro, Luciano! Aqui est√° o arquivo completo e aprimorado de Nova Solicita√ß√£o (novo.php), com:
    ‚Ä¢ Verifica√ß√£o de sess√£o 
    ‚Ä¢ Inser√ß√£o segura no banco 
    ‚Ä¢ Campos: t√≠tulo, descri√ß√£o, prioridade 
    ‚Ä¢ Status inicial e data de abertura 
    ‚Ä¢ Estilo visual b√°sico 


Resultado
    ‚Ä¢ dashboard.php: mostra resumo com cards e gr√°fico de barras 
    ‚Ä¢ listar.php: lista chamados com filtros por status e prioridade, e a√ß√µes como editar e avaliar 

editar
Funcionalidades
    ‚Ä¢ Busca o chamado pelo id 
    ‚Ä¢ Exibe os dados atuais em um formul√°rio 
    ‚Ä¢ Permite editar t√≠tulo, descri√ß√£o, prioridade e status 
    ‚Ä¢ Atualiza no banco e confirma sucesso 
Se quiser, posso criar o avaliar.php com estrelas e coment√°rios para chamados conclu√≠dos. Quer seguir com isso?
! Vamos criar o avaliar.php, onde o usu√°rio pode dar uma nota (de 1 a 5 estrelas) e deixar um coment√°rio sobre o chamado.
Funcionalidades
    ‚Ä¢ Verifica se o chamado j√° foi avaliado 
    ‚Ä¢ Permite selecionar de 1 a 5 estrelas 
    ‚Ä¢ Campo de coment√°rio opcional 
    ‚Ä¢ Salva avalia√ß√£o no banco 
O PHPMailer √© confi√°vel, seguro e amplamente usado em sistemas profissionais. Vamos configurar passo a passo o envio de e-mails com PHPMailer usando SMTP ‚Äî por exemplo, com Gmail.
‚öôÔ∏è 1. Instalar PHPMailer via Composer
Se voc√™ ainda n√£o tem o Composer instalado, baixe aqui. Depois, no terminal da pasta do seu projeto:
composer require phpmailer/phpmailer 
Isso criar√° a pasta vendor/ com os arquivos necess√°rios.
üìÅ 2. Criar o arquivo email.php

üîê 3. Gerar senha de aplicativo no Gmail
Se estiver usando Gmail, voc√™ precisa ativar a verifica√ß√£o em duas etapas e gerar uma senha de aplicativo:
    1. V√° para https://myaccount.google.com/security 
    2. Ative a verifica√ß√£o em duas etapas 
    3. Em "Senhas de app", crie uma nova senha para "Mail" ‚Üí "Outro (personalizado)" 
    4. Use essa senha no lugar da sua senha normal no campo $mail->Password 
üì® 4. Integrar ao avaliar.php
No final do bloco de sucesso:
include 'email.php'; $mensagem = "O chamado #$id foi avaliado com nota $avaliacao.\n\nComent√°rio:\n$comentario"; $enviado = enviarEmail("admin@seudominio.com", "Nova avalia√ß√£o recebida", $mensagem); if ($enviado) { echo "
üìß Notifica√ß√£o enviada com sucesso!
"; } else { echo "
‚ö†Ô∏è Erro ao enviar notifica√ß√£o por e-mail.
"; } 
Ó∑ôÓ∑ö
‚úÖ Resultado
Sempre que um chamado for avaliado, o administrador receber√° um e-mail com os detalhes. Voc√™ pode expandir isso para enviar:
    ‚Ä¢ Confirma√ß√£o ao usu√°rio que avaliou 
    ‚Ä¢ Notifica√ß√µes de novos chamados 
    ‚Ä¢ Alertas de chamados atrasados 
Se quiser, posso te ajudar a criar um painel de configura√ß√µes para definir e-mails de destino, ativar/desativar notifica√ß√µes, ou at√© enviar e-mails com layout HTML. Quer seguir por esse caminho?
Luciano! Vamos implementar um painel de configura√ß√µes de e-mail para o administrador, permitindo:
    ‚Ä¢ ‚úÖ Definir o e-mail de destino das notifica√ß√µes 
    ‚Ä¢ ‚úÖ Ativar ou desativar envio autom√°tico 
    ‚Ä¢ ‚úÖ Salvar essas configura√ß√µes no banco 
    ‚Ä¢ ‚úÖ Usar essas configura√ß√µes no envio via PHPMailer 
üóÉÔ∏è 1. Estrutura do banco de dados
Adicione uma tabela chamada configuracoes:
CREATE TABLE configuracoes ( id INT PRIMARY KEY AUTO_INCREMENT, email_destino VARCHAR(255) NOT NULL, notificacoes_ativas BOOLEAN DEFAULT TRUE ); 
Insira uma configura√ß√£o padr√£o:
INSERT INTO configuracoes (email_destino, notificacoes_ativas) VALUES ('admin@seudominio.com', TRUE); 
‚öôÔ∏è 2. Arquivo: config_email.php
prepare($sql); $stmt->bind_param("si", $email, $ativo); $stmt->execute(); echo "
‚úÖ Configura√ß√µes atualizadas!
"; } // Buscar configura√ß√µes atuais $sql = "SELECT * FROM configuracoes WHERE id = 1"; $result = $conn->query($sql); $config = $result->fetch_assoc(); ?> 
‚öôÔ∏è Configura√ß√µes de Notifica√ß√£o por E-mail
E-mail de destino:


> Ativar envio autom√°tico de notifica√ß√µes 

üíæ Salvar Configura√ß√µes 
Ó∑ôÓ∑ö
üì¶ 3. Atualizar email.php para usar configura√ß√µes
query($sql); $config = $result->fetch_assoc(); if (!$config['notificacoes_ativas']) return false; $para = $config['email_destino']; $mail = new PHPMailer(true); try { $mail->isSMTP(); $mail->Host = 'smtp.gmail.com'; $mail->SMTPAuth = true; $mail->Username = 'seuemail@gmail.com'; $mail->Password = 'senha_do_app'; $mail->SMTPSecure = 'tls'; $mail->Port = 587; $mail->setFrom('seuemail@gmail.com', 'Sistema de Chamados'); $mail->addAddress($para); $mail->Subject = $assunto; $mail->Body = $mensagem; $mail->send(); return true; } catch (Exception $e) { error_log("Erro ao enviar e-mail: {$mail->ErrorInfo}"); return false; } } 
üì® 4. Atualizar avaliar.php para usar nova fun√ß√£o
include 'email.php'; $mensagem = "O chamado #$id foi avaliado com nota $avaliacao.\n\nComent√°rio:\n$comentario"; if (enviarEmail("Nova avalia√ß√£o recebida", $mensagem)) { echo "
üìß Notifica√ß√£o enviada com sucesso!
"; } else { echo "
‚ö†Ô∏è Notifica√ß√£o n√£o enviada (desativada ou erro).
"; } 
Ó∑ôÓ∑ö
‚úÖ Resultado
    ‚Ä¢ Painel de configura√ß√µes acess√≠vel via config_email.php 
    ‚Ä¢ Admin pode alterar e-mail de destino e ativar/desativar notifica√ß√µes 
    ‚Ä¢ Avalia√ß√µes disparam e-mails automaticamente se ativado 
Se quiser, posso adicionar envio com layout HTML, ou permitir m√∫ltiplos destinat√°rios. Quer deixar o e-mail mais bonito com logotipo e formata√ß√£o?
Avaliar.php
Formul√°rio de avalia√ß√£o por estrelas 
    ‚Ä¢ Coment√°rio opcional 
    ‚Ä¢ Verifica√ß√£o se o chamado j√° foi avaliado 
    ‚Ä¢ Registro da avalia√ß√£o no banco 
    ‚Ä¢ Envio autom√°tico de e-mail via PHPMailer usando configura√ß√µes din√¢micas 
‚≠ê Arquivo: avaliar.php
‚ùå ID inv√°lido.
"; exit; } // Buscar chamado $sql = "SELECT * FROM solicitacoes WHERE id = ?"; $stmt = $conn->prepare($sql); $stmt->bind_param("i", $id); $stmt->execute(); $result = $stmt->get_result(); $chamado = $result->fetch_assoc(); if (!$chamado) { echo "
‚ùå Chamado n√£o encontrado.
"; exit; } // Verifica se j√° foi avaliado if (!empty($chamado['avaliacao'])) { echo "
‚≠ê Avalia√ß√£o do Chamado #{$chamado['id']}
"; echo "
Nota: {$chamado['avaliacao']} ‚≠ê
"; echo "Coment√°rio: " . nl2br(htmlspecialchars($chamado['comentario'])) . "
"; echo "üîô Voltar √† lista"; exit; } // Processa avalia√ß√£o if ($_SERVER['REQUEST_METHOD'] === 'POST') { $avaliacao = $_POST['avaliacao'] ?? null; $comentario = $_POST['comentario'] ?? ''; if (!$avaliacao || $avaliacao < 1 || $avaliacao > 5) { echo "
‚ùå Selecione uma nota v√°lida entre 1 e 5.
"; } else { $sql = "UPDATE solicitacoes SET avaliacao = ?, comentario = ? WHERE id = ?"; $stmt = $conn->prepare($sql); $stmt->bind_param("isi", $avaliacao, $comentario, $id); if ($stmt->execute()) { echo "
‚úÖ Avalia√ß√£o registrada com sucesso!
"; echo "üîô Voltar √† lista"; // Enviar notifica√ß√£o por e-mail $mensagem = "O chamado #$id foi avaliado com nota $avaliacao.\n\nComent√°rio:\n$comentario"; if (enviarEmail("Nova avalia√ß√£o recebida", $mensagem)) { echo "
üìß Notifica√ß√£o enviada com sucesso!
"; } else { echo "
‚ö†Ô∏è Notifica√ß√£o n√£o enviada (desativada ou erro).
"; } exit; } else { echo "
‚ùå Erro ao salvar avalia√ß√£o.
"; } } } ?> 
‚≠ê Avaliar Chamado #
Nota:
 

Coment√°rio:


üì® Enviar Avalia√ß√£o 
Ó∑ôÓ∑ö
‚úÖ Requisitos para funcionamento
    ‚Ä¢ A tabela solicitacoes deve ter os campos avaliacao INT e comentario TEXT 
    ‚Ä¢ O arquivo email.php deve estar configurado com PHPMailer e buscar as configura√ß√µes no banco 
    ‚Ä¢ A tabela configuracoes deve existir com os campos email_destino e notificacoes_ativas 
Se quiser, posso montar agora um painel de satisfa√ß√£o com m√©dia de avalia√ß√µes por executor ou tipo de servi√ßo. Quer seguir por a√≠?



Requisitos para funcionamento
    ‚Ä¢ A tabela solicitacoes deve ter os campos avaliacao INT e comentario TEXT 
    ‚Ä¢ O arquivo email.php deve estar configurado com PHPMailer e buscar as configura√ß√µes no banco 
    ‚Ä¢ A tabela configuracoes deve existir com os campos email_destino e notificacoes_ativas 

Checklist Final
    ‚Ä¢ [x] avaliar.php funcionando com formul√°rio e l√≥gica 
    ‚Ä¢ [x] email.php configurado para envio din√¢mico 
    ‚Ä¢ [x] Tabelas criadas com os campos necess√°rios 
    ‚Ä¢ [x] Configura√ß√µes de e-mail armazenadas no banco 
    ‚Ä¢ [x] PHPMailer instalado via Composer 

